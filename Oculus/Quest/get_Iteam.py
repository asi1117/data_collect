#!/usr/bin/env python3
# -*- coding: utf-8 -*-
import warnings
warnings.simplefilter(action='ignore', category=FutureWarning)
import pandas as pd
import time
import datetime
from selenium.webdriver import Chrome
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from bs4 import BeautifulSoup
import traceback
# %%% relevent website
#id_list = ['2734683026604050', '1081190428622821', '2031736060288351', '2472374902778951', '1111640318951750', '1198491230176054', '1069133196442024', '1659250310762797', '1368187813209608', '909129545868758', '872183756232656', '1012593518800648', '1446648452044502', '866068943510454', '1896033800492877', '1115950031749190', '2239010642792458', '1195983747083203', '1216866718419997', '991947850898357', '1051675701628540', '2003842656408578', '989106554552337', '988773191157765', '1750518241672539', '1696375800396854', '1052821828143109', '1101975213197949', '1818689078164305', '1340764792673326', '1196665787048646', '1044201475659209', '1130182873666293', '3173607405998636', '1275664972562703', '1026648920729545', '1872428116153565', '1225484597472435', '1207497572657758', '1942343732456615', '1312908222125035', '1332617726752141', '1524154440988718', '1360938750683878', '2172302616173639', '1119889274794166', '1155989791152285', '1592992710742424', '1994433897296970', '905830242847405', '1226573594029268', '1951786524835344', '2465382086809441', '1653313354717205', '1056843937708939', '2739977019349635', '903220709784607', '1070597869619581', '1388204261277129', '1425858557493354', '998016373574782', '1404029529689104', '1487646731309118', '1091604990907791', '1769388509760051', '888118474643317', '775907692521284', '682000918570174', '1490109271079729', '1312004685551779', '1143046855744783', '1184265584927845', '1441504575894342', '992124094188963', '1429983913766649', '1714408811965644', '1012092142167066', '1891601494191063', '1253785157981619', '1389400304430016', '818716001584299', '1162702973806457', '1633794490011975', '966424573479101', '1302715766408798', '1108062115894494', '1536415903036034', '1331308656942021', '929508627125435', '1001689043272976', '809977902464604', '957951994279023', '1001514393269541', '984294025016007', '1833318536683635', '2250162051701470', '1222120447828084', '1241059555937266', '1171399169574498', '1018772231550220', '1972405206119760', '1725310600873633', '1378281665554971', '1711938725528735', '1014328505355842', '993520564054974', '950252648400726', '986581138113138', '1480133245392512', '1041660492551211', '1962004113896614', '1087949831298664', '1644518545573145', '1696308540462484', '2143422815706213', '1021037564670339', '847961205328789', '1171384969561334', '1018110521596029', '703660393091961', '1620367211417812', '1495367467245425', '922402147808085', '989322321141039', '1003772722992854', '809121772547247', '1037581286304890', '1741124389277542', '1382388801879442', '2124641230881553', '1943333329057022', '1462259830529109', '1471853306166046', '1867571473257022', '1563237450413416', '2051702344842370', '1088797664494908', '1708711415835546', '1041269642652957', '1308114652607170', '2348743601909175', '1780851861955698', '1859625197439973', '1728510120524947', '1364142430316562', '1236704876366734', '1812602608857115', '1644704682289199', '1709744419154115', '1626271697482695', '1120724884606195', '1547059632027955', '1639775789405182', '1163831313746254', '1255051101208827', '1401567799948153', '1271135186302289', '1028758880514808', '1018613041536358', '1032148483570028', '903642616411015', '1264016100304079', '660396644063513', '1415202825245458', '1023198204421743', '1303301169681067', '733640976736718', '1101455296589556', '1116533615035202', '899545263499753', '1694532470661281', '1137856592928098', '1605035749512556', '415780415213995', '1246557958752994', '2683634734986656', '1154566214634850', '1098199910279475', '1037808739680311', '1072258406206619', '1801357889967877', '1208507739163035', '1003346543059420', '1879234558760878', '1297659106991992', '872418872856459', '881361898599169', '1859059894211295', '1586465688076128', '877457905696954', '1093392027448406', '1304877726278670', '1732987253448804', '1554270381357502', '974372449301580', '1148331945191570', '1588652084550780', '1671004309616863', '1106538986077576', '1905346406155912', '1263430353678786', '996543650418117', '2331434793563555', '2265255760180455', '1187328834649164', '1838305282891104', '1112286198806785', '1364532560285203', '1104933179620125', '2211192328903176', '1668330116583564', '997678176960598', '2001971263187898', '2032038366877571', '1744842135602990', '1513995308673845', '1868957053126430', '1365103133543739', '1262389360531123', '2532685170079555', '1211584462259537', '2130638416972998', '799798880126508', '1337951029631684', '1942845939155229', '1257029974329451', '940852485970061', '945831062186742', '2175239282518665', '1233145293403213', '1757663734343014', '1427932007323613', '1475034132510246', '974392602669459', '1491102584268860', '387422848047994', '1246744618768922', '1004289456346194', '1369078409873402', '2190323657748572', '1637736282963856', '1393269044113553', '1237907126312932', '1502397286503347', '1280760238690439', '1239815839467485', '819717231487370', '1072303152793390', '1219205288123671', '1477883658957255', '1257633284291446', '1892468820862074', '1630322847038003', '926295224105459', '996540877086329', '1340264072670004', '899832023465705', '922076897882360', '1330761650293612', '1077839092284541', '1297777480332012', '3076088545738492', '1304948539547215', '1009402919137992', '1961361990541898', '784129301688154', '3186673774691599', '1599261850117286', '1328782413814538', '1980580318635151', '2434016836627834', '1784204484986126', '1369785789766641', '1780741661944300', '1217155751659625', '1669550669760933', '1573602809425326', '2021788751258719', '1016967501697367', '1006887936048510', '943711145677315', '1861374180578892', '1958452074228276', '1317508468268608', '941682542593981', '1792930504091043', '1437580549697592', '2314034471989368', '900601920057477', '1238778229506924', '1533124226720250', '966139690133648', '1828209320545247', '2178820058825941', '1178419975552187', '898496780279952', '1707911292615524', '1439668599404073', '1534570166634001', '1410300449032431', '1098557506902587', '1429661883829354', '1000027913449340', '1320373124698683', '1048901365146027', '1755851804523719', '1011429558899116', '1430238500377664', '974756422624331', '1170137896430023', '2159136720763790', '864116003696703', '967071646715932', '1819708568043609', '1825580397453104', '1939359989460713', '1260824423952313', '2825239134154718', '1043217179077622', '828617117248161', '1781819921845915', '2317961328270454', '1266713943402009', '1694083923995617', '1488807047863347', '1944128808953270', '2069106006465690', '2339909156084669', '1789924451050066', '934743126624720', '1880529828633843', '1004798886239391', '2046553198725213', '1414258035336280', '1364510803659063', '1681506908561513', '1936945119708302', '1079392225455443', '1433592913387102', '1897965323553985', '1801263533272595', '2529055677154156', '1120256171368197', '804448142992694', '1795983737103675', '1794768633874464', '1570264743013105', '1266881563371842', '1174445049267874', '1873099679429920', '1184398028297648', '926273867499264', '2030694353661802', '1458299040905281', '1571751676192063', '804793456312081', '2272579216119318', '1109834805714906', '985909884864274', '980646215356452', '1002693133144449', '2009355295817444', '1834223926601207', '1170806652965871', '1497528783648022', '1501313913294054', '1607040142706621', '1829204770438255', '1244223995590142', '1021657354608408', '1939867142691966', '1530045857049581', '1180401875303371', '1514447601900695', '2011966668836710', '2001576096577657', '1177199742298383', '2050324821663886', '2127581660649280', '744866972281509', '1543794052351127', '1446531122131281', '1099633596804669', '1601514943210794', '2043644582332313', '1205125509544107', '1497930883561495', '2503391089702495', '1708460232526585', '1130704570365536', '1151513668302336', '1548193245307133', '1968393643280122', '1933468783441840', '1442212565828021', '1563751417029979', '1429281503799639', '1406167286077784', '961264563968531', '1431157710331223', '1371447689639525', '1370334862981714', '1115649871780498', '1830344467037360', '2437729269585986', '676747619095568', '859122784213043', '1406554962733693', '1112894815499116', '2069539006493937', '1386167224757449', '1290585534319768', '1239560486085016', '2833444230004406', '945551678861092', '1171309249602062', '1280395985421431', '1707073412706480', '2214244628588915', '1212860585450625', '1515033125183820', '1956900951038026', '1765028786864131', '1379869002120921', '1605007349543688', '1717687071655033', '1319276384868331', '1681857008586292', '1564171116930006', '1264718836934108', '828122903980238', '1823346271013120', '1228071717284478', '1700554169987044', '1074931595875342', '1055156107907425', '1314003758671555', '1184973554901426', '954357068025555', '1030319333676340', '1361822510535509', '1026362144104451', '1881504281860877', '1833034253377885', '1042977572425760', '1303015946406069', '1434219906691531', '1843267285686806', '1395843387173061', '711797622254827', '1413798101973547', '2092820447458370', '1126239044115355', '1368207159902538', '2037840999649560', '1936934136403643', '1305408259557493', '1316179438395871', '1807317409310025', '1329190610448460', '1220851764689273', '963903800312416', '1630925520317416', '1482485498505274', '1266404800079388', '1083926491698432', '1437622026333338', '2221241921234738', '2803888673016355', '1570513163000320', '1116053935181362', '1808843195822325', '2192753377451572', '1649724921807779', '1558212447531205', '1138122202866373', '1355935294487891', '1127998673964713', '1942516192430431', '1210327769037332', '1458496604197649', '1764424466901461', '1884062488298857', '1818052548258452', '1093964344057482', '1277986908983013', '1072584966163425', '1821664114572538', '1762660917100389', '1266926693358965', '2716628805044056', '1171450826315858', '1176018695854120', '2027380550714273', '1218229098261852', '2417599994919704', '1549820201776682', '1596813403689581', '1646255608742335', '1338537909564174', '933665076734267', '2749858231721083', '2125948974167426', '1233189620061747', '1838344072944378', '2430833096985070', '1936824813058020', '1647847635331593', '1890872267591369', '2873869776021085', '1309916592361067', '2445794025511978', '1258599840927577', '2382921018457845', '2377879608899124', '1478494128914114', '1340822289353901', '1659030634151539', '1359906420787878', '1152665388102053', '1982154598578998', '1331089120285846', '1764886996904959', '2617326894946403', '1703620889728825', '1510962015642292', '1766848360109262', '2020666424613572', '1723287424432047', '1037679502967606', '1132882333473147', '3127208930638510', '3016233988450211', '1269203056439779', '1501889473210330', '1875140845836625', '1802689989806230', '1823664821020140', '2521589964574061', '2197829460229187', '1551361978320246', '1530756597021244', '2568415779851053', '1989020754502226', '1731009406957041', '1746672708729216', '1676378872427800', '2084362931627708', '2004005749696280', '2341952762531753', '2374565852633484', '1801857816550517', '1585189354891625', '1310377192398042', '2455309591158227', '2109562142495943', '2875283785833437', '2395882980466838', '1272728086074533', '1379022322193957', '1800943179957282', '1447092712011287', '1871244019630887', '1571143122994237', '2685037768176551', '2157136304330778', '1656567794425255', '1739861202717667', '2283102065036440', '1130324113733102', '1635318426577306', '2298826323547241', '2499688966768965', '1813649398677830', '1249428591772689', '1978368332236407', '2412559585428662', '1608277092625410', '1217471878365796', '2315978125097109', '2343958732291362', '1963156610459395', '1809390489075678', '1569100436498535', '1393627804009838', '1528291040618527', '1539436692808738', '2244454088961520', '1264925233525864', '1633591910075916', '1906169082766471', '1027083374084674', '1204731822978255', '1526202524057260', '1593448240768245', '1549570518416178', '1495752170441838', '863429780424942', '980771811959458', '1182380518443666', '1942869395829207', '1612596228785432', '1083042371786607', '2467364466642773', '2236816239697496', '1848693088593147', '2322509624489511', '1727568557317122', '1036513769804225', '1533231583438824', '1810750645607190', '1861486733959164', '1934325366646856', '1052304794886863', '868994813199968', '1693860204017792', '1371598756291017', '2064058367012312', '1899493143484255', '2153044944803186', '2814164681959269', '2245058338849660', '1482674305192007', '1680689561950120', '1831386233574800', '2494578553916335', '1731587616863812', '894396277346731', '1819090908122358', '1536691996410477', '1445682265455753', '1388639557852285', '2004480829667770', '2074142215952465', '1269833109744113', '1840170016011204', '1351689804896807', '998287880282507', '1721877701263640', '1717426128288170', '1193480720725056', '1227243557300361', '1580302658646825', '2327369464045681', '2848450968560936', '1806879052690683', '1274544649278305', '1261519543970221', '1306960842762131', '1409251412531103', '2598026453602199', '2062124740479338', '1313745845396420', '1402173103165354', '1319888571402315', '2473226992719549', '1591073590972727', '2151091991592678', '1452659618102144', '1733132530096377', '1126929450705962', '2475982895775029', '1786072758117223', '1505100179544569', '892995210804059', '2815210175190743', '1625302357538878', '1119119774880083', '1829062873855832', '1125327370889861', '1621604147940095', '1449841275090025', '1077869272314219', '1360558234048246', '802980189823946', '1269884236472140', '2019557031470428', '814255758700053', '1722022914546610', '1424068284285734', '921646244607721', '911038425617832', '1794257190678814', '2435949193099067', '1535006473286280', '1333332663409996', '1783477358391522', '2192488214151961', '1473162759461410', '1432150526836829', '1586295238060018', '2348525895219446', '1913419862118272', '2954726801212018', '1293266627457596', '1339334626175018', '1408091119267920', '2583849224982166', '1554522858001622', '750910405009643', '1873145426039242', '1744923325584653', '2425430174174472', '1221236131237268', '1166109406809620', '1439655272812082', '1633473423412643', '1766581036755768', '1929582850483565', '2372061992856432', '1001270106613504', '1548858791808985', '2177793142230915', '1896020410412423', '2224171020955231', '1460009300763639', '2224518224242612', '2664057663668988', '1846751478700515', '2447509701930418', '1304020072983542', '1606205652783585', '980197902105373', '2065023576942465', '1805899282773910', '1980860325355938', '1882294268491131', '2414647548548968', '2037218276323946', '1883364855049025', '1358967810826101', '1556750707686722', '1602353583119271', '1916662391793038', '1145588855531274', '1835083489951084', '1156315807813887', '1666674673366568', '1690625944347859', '1333056616777885', '1213846312045524', '1461392610653814', '1274858305906473', '2496339380383114', '2775569789182890', '2244062122297088', '1400181626701009', '1923407444400871', '1815215245225612', '1343033292436240', '1552250918219351', '1547231975368367', '1652078998203854', '2149603455084781', '1053122028117467', '1681590791888234', '1242416849112952', '2297649763591594', '1610155619109869', '1645454705482018', '1642935482491477', '1776111379163747', '1848918321866938', '1228605373923715', '1445083275615167', '1397433300276519', '2365996083419774', '2267941936565944', '1058565827499028', '1978266905591447', '1561251624004468', '1377122479022118', '1434373533324180', '1058884440821872', '1506609942759571', '1269189123141874']
# 1389

# %%% initialize chrome
# open website
driver = Chrome()
time_star = time.time()
# %%% collect all reviews
condition_to_continue = True
dataframe = pd.DataFrame()
count = 0
#id_list =['2734683026604050', '1081190428622821', '2031736060288351', '2472374902778951', '1111640318951750', '1198491230176054', '1069133196442024', '1659250310762797', '1368187813209608', '909129545868758', '872183756232656', '1012593518800648', '1446648452044502', '866068943510454', '1896033800492877', '1115950031749190', '2239010642792458', '1195983747083203', '1216866718419997', '991947850898357', '1051675701628540', '2003842656408578', '989106554552337', '988773191157765', '1750518241672539', '1696375800396854', '1052821828143109', '1101975213197949', '1818689078164305', '1340764792673326', '1196665787048646', '1044201475659209', '1130182873666293', '3173607405998636', '1275664972562703', '1026648920729545', '1872428116153565', '1225484597472435', '1207497572657758', '1942343732456615', '1312908222125035', '1332617726752141', '1524154440988718', '1360938750683878', '2172302616173639', '1119889274794166', '1155989791152285', '1592992710742424', '1994433897296970', '905830242847405', '1226573594029268', '1951786524835344', '2465382086809441', '1653313354717205', '1056843937708939', '2739977019349635', '903220709784607', '1070597869619581', '1388204261277129', '1425858557493354', '998016373574782', '1404029529689104', '1487646731309118', '1091604990907791', '1769388509760051', '888118474643317', '775907692521284', '682000918570174', '1490109271079729', '1312004685551779', '1143046855744783', '1184265584927845', '1441504575894342', '992124094188963', '1429983913766649', '1714408811965644', '1012092142167066', '1891601494191063', '1253785157981619', '1389400304430016', '818716001584299', '2250162051701470', '1162702973806457', '1633794490011975', '966424573479101', '1302715766408798', '1108062115894494', '1536415903036034', '1331308656942021', '929508627125435', '1001689043272976', '809977902464604', '957951994279023', '1001514393269541', '984294025016007', '1833318536683635', '1222120447828084', '1241059555937266', '1171399169574498', '1018772231550220', '1972405206119760', '1725310600873633', '1378281665554971', '1711938725528735']
#id=1331308656942021 有问题
id_list =['4020038261419508', '4220006248051477', '4988470131168299', '2821509184606966', '3890197214406211', '4046879905345967', '5230505793640167', '3106117596158066', '3815577785147028', '5437449896288644', '3158342884265828', '5077315605654672', '4554248281328321', '2280319701979278', '5334662579895130', '4900967296622279', '3967680489996895', '2302319493201737', '3671539682885620', '6937410016334124', '5157404804284116', '2374555582668563', '4705981139481778', '1968697563211639', '2465388190184288', '4281519998581593', '2731491443600205', '3215828205181680', '4015163475201433', '3594982710558708', '4584847304916084', '3438333449611263', '4048766301899067', '4531913893511480', '3589600511140268', '3684804704932159', '5352920984748732', '6148239151883485', '3831620133609128', '4014704425248676', '4657783360977535', '2160364850746031', '4847484705291911', '3488568914506549', '3630025217090808', '3652037328256745', '3647259232032222', '3683568971682157', '3697657733661230', '3899112273551602', '2031826350263349', '4148745208478773', '6126469507395223', '6102857836422862', '4949538568409451', '4636949963023496', '4243111539050423', '4103186286403181', '2637179839719680', '4714094898617280', '3749621795127676', '3566126356743668', '3385318684883998', '4197310213682418', '5068085479875775', '3878215958952165', '2097356583640894', '3982869578392875', '4207810312567000', '4723352327707414', '2570320959694625', '3759841040728627', '3230671513714717', '3327842470656115', '3432432656819712', '2562230633857728', '3635172946605196', '3931148300302917', '2301375123298882', '4214902388537196', '2970998659623177', '2514011888645651', '3327317663977182', '3600836956645933', '3669819606376951', '4901911359882668', '2948202345202575', '3922378427824210', '2886115781495034', '3916601848368970', '2913958855307200', '2544573735586536', '3044409625637497', '3256881337690839', '3414062495337180', '3003818956320639', '5353996901307344', '1918967004876383', '3126295830741280', '3816141331792031', '4784171281624823', '4143574335654608', '3317083428365473', '3420508614708029', '3202625546470498', '3422717251188752', '3591949650852844', '3634830803298285', '2441213515992073', '3180994211970184', '2562090053828017', '3895994960415614', '3285668754893704', '2088366894520136', '2236053486488156', '2753873371404693', '2401648309868679', '3392175350802835', '4113720305326115', '2792447070854325', '1760132027421053', '3688751474502123', '3433698816645881', '2108767382537806', '2617233878395214', '2548290978591281', '3070239359662935', '1884760688319818', '3682965538398068', '4603898999650318', '3193476307357463', '3755552521124500', '3882524545155280', '3349689215139117', '3844657785549661', '3622969487764448', '2985592331490872', '3727135290647922', '3726478607381266', '2853664488067174', '3323166227771391', '2708465082504733', '2898438393596104', '2719294624823942', '3723136981093558', '3231001163584154', '2537261906377373', '3446712548672561', '2436897736439055', '2977398372335251', '2395213267267320', '2446271755437605', '3484270071659289', '3092079454190601', '3789736921099233', '1961984627245151', '2799962826754702', '2564158073609422', '3043045549099845', '2897337400373711', '2610547289060480', '2913996261988381', '2814449548618112', '2249318828413747', '3857024597703276', '2446085128829455', '4174249979259348', '3675568169182204', '1920879634657108', '2307085352735834', '2159739540797724', '2567459230020142', '2462678267173943', '2245426295493320', '2557519677620753', '2264524423619421', '2874244485968712', '3384742628260377', '2202354219893697', '2866842926757434', '2327302830679091', '2927141310670477', '2004774962957063', '2807364355977144', '2540541942723653', '2004328649624954', '3895528293794893', '2900834523285203', '3002729676463989', '2540393919317658', '4421540051219573', '2677344882310094', '2334376869949242', '2849273531812512', '2873640696088444', '3159481670763523', '3162101440489458', '3087966124548124', '2450698034945641', '2632963266829659', '2302118823192509', '3327542460590280', '2718107161580827', '2833307773392914', '2942600475808591', '2926036530794417', '2773034772778845', '2685959161497510', '2412327085529357', '2933720383334150', '3793077684043441', '2531338473623578', '3386618894743567', '2371757336252737', '2484044451715693', '2215004568539258', '1891638294265934', '2451131601675079', '3628344387191267', '1924930950878181', '3457685900909916', '3759082287499712', '2449350021843569', '2652937004788947', '1706349256136062', '2632034163584300', '2124523024270629', '2476104599150595', '2702419963135346', '1995434190525828', '2260701747375712', '2366136696841248', '2522558964527688', '2333124776756148', '3044656825604617', '2615129151844974', '1976071352472244', '2592096760842149', '2436667223120459', '2557465320986444', '3006696236087408', '3397161850356438', '2173576192720129', '2359857214088490', '1990852827683397', '2736496286381191', '2507216576060698', '2032870023439846', '2393300320759737', '2967784573246968', '2406880882663555', '2515021945210953', '2190353671014400', '1954488057986071', '2280285932034855', '2376737905701576', '2245906048808858', '2299967930057156', '2228678273856228', '2426206484098337', '1917371471713228', '2917608654922903', '2439217169469931', '1427490644042488', '2279149812197085', '2104963472963790', '2436558143118760', '3008315795852749', '2567395559960697', '2725629380835491', '2404437756348346', '2078236868960051', '2082941345119152', '2128482130504783', '2115015981923610', '2223615721048141', '2096339947076151', '2055718171162796', '1551165681653074', '2121787737926354', '2586839431358655', '2257223740990488', '2675955252474460', '2221553561229188', '2133027990157329', '2035353573194060', '2582932495064035', '2325731427501921', '2434361173248640', '2345082335516570', '1978992975501648', '2337198749686376', '1951863938215666', '2180753588712484', '2055554051161375', '1995306573932043', '2398880980156491', '2382576078453818', '2706567592751319', '2180252408763702', '1903584373052985', '1794123900713107', '2274617532624269', '2285803881494677', '2255408847836468', '1587090851394426', '2094303753986147', '1946326588770583', '2560149374058829', '2481987975166999', '2736092446433068', '2299215130112875', '2033429253367669', '1642239225880682', '1958100334295482', '2812851825399383', '3064046640291676', '2459503397416283', '2022341094553436', '2184912004923042', '2448060205267927', '2108775495884888', '2366245336750543', '1921533091289407', '1856672347794301', '1952355814856769', '3235570703151406', '2718606324833775', '2658975244130479', '2616537008386430', '2497738113633933', '2453152771391571', '2352932654734987', '2327205800645550', '2322529091093901', '2267061756700952', '2188021891257542', '2173678582678296', '2164469606967296', '2134272053250863', '2134077359973067', '2111191602278229', '2096570290365140', '2088119334554800', '2082595615120854', '2078376005587859', '2046607608728563', '2017050365004772', '2010043642376517', '1987283631365460', '1947925211962268', '1935017546592600', '1906871599408213', '1893756264000446', '1860984660605547', '1854124104686464', '1853479764707533', '1810693125705825', '1798409083604479', '1756328964489238', '1663790613725314', '1654565391314903', '1611681078875316', '705576999566582', '2225300714196671', '2063931653705427', '1790834284361209', '2444056018972158', '2131072803612066', '2062507817126022', '1780841635357133', '1758986534231171', '2823006367725446', '2215140511885250', '1931356740318898', '1916519981771802', '2370815932930055', '2002317119880945', '2299465166734471']
#print(len(id2_list))
print(len(id_list))
n = 1
k = 0
worry_list = []
#得到商品的所有共同标签，将标签内容传到soup中
#循环打开游戏的页面，获取上面的信息
for id in  id_list:
    # 得到商品id，通过访问url将商品信息输进去
    url = 'https://www.oculus.com/experiences/quest/' + str(id)
    print(n)
    n = n+1
    k = k+1
    driver.get(url)
    driver.maximize_window()
    windows = driver.window_handles  # 获得多个窗口句柄
    print(windows)
    #node_handle = driver.current_window_handle
    driver.switch_to.window(windows[-1])
    #print(node_handle)
    #driver.switch_to.window(windows[0]) #切换窗口
    time.sleep(4)
    try:
        page = driver.find_element(by=By.XPATH, value='//*[@id="mount"]/div/div[2]/div/div/div[2]')
        #print(page)
        soup2 =BeautifulSoup(page.get_attribute('innerHTML'),"html.parser")
    except:
        print('第二页跳转失败')
        worry_list.append(id)
        continue
    try:
        app_details = soup2.find_all('div', attrs={'class': 'app-details-row__right'})
        #print(app_details)
    except:
        print("取游戏细节出错")
        worry_list.append(id)
        print(worry_list)
        continue
    try:
        iteam_name = soup2.find('div', attrs={'class': 'app-description__title'}).text
        print(iteam_name)
    except:
        iteam_name = ''
        print('获取商品名字错误')
    try:
        iteam_description = soup2.find('div', attrs={'class': 'clamped-description__content'}).text
        print(iteam_description)
    except:
        iteam_description = ''
        print('获取商品简介')
    try:
        iteam_price = soup2.find('span', attrs={'class': 'app-purchase-price'}).text
    except:
        iteam_price = ''
        print('价格失败')
    try:
        print(len(app_details))
        print('到这一步了')
        dataframe = dataframe.append(pd.DataFrame({
            'Game_Id': str(id+','),
            'Game_Name': iteam_name,
            'Game_price': iteam_price,
            'Game_description': iteam_description,
            'Game_Modes': app_details[0].text,
            'Game_PlayerModes': app_details[1].text,
            'Game_Controllers': app_details[2].text,
            'Game_Platforms': app_details[3].text,
            'Game_Genres': app_details[4].text,
            'Game_Languages': app_details[5].text,
            'Game_Version': app_details[6].text,
            'Game_Developer': app_details[7].text,
            'Game_Publisher': app_details[8].text,
            'Game_Website': app_details[9].text,
            'Game_ReleaseDate': app_details[10].text,
        },
            index=[count]))
        count += 1
        print(count)
        print(id+'.csv')
        dataframe.to_csv("3Item_message.csv", index=False, sep=',', encoding='utf_8_sig')
        time.sleep(2)
    except:
        print(id ,"写文件出错")
        worry_list.append(id)
        print(worry_list)






    # try:
    #     game_Modes = soup2.find('div',attrs={'class':'app-details-row__right'})
    # except:
    #     game_playWays = soup2.find('')
    #
    #
















