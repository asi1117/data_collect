#!/usr/bin/env python3
# -*- coding: utf-8 -*-
import warnings
warnings.simplefilter(action='ignore', category=FutureWarning)
import pandas as pd
import time
import datetime
from selenium.webdriver import Chrome
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from bs4 import BeautifulSoup
import traceback
# %%% relevent website
#id_list = ['2734683026604050', '1081190428622821', '2031736060288351', '2472374902778951', '1111640318951750', '1198491230176054', '1069133196442024', '1659250310762797', '1368187813209608', '909129545868758', '872183756232656', '1012593518800648', '1446648452044502', '866068943510454', '1896033800492877', '1115950031749190', '2239010642792458', '1195983747083203', '1216866718419997', '991947850898357', '1051675701628540', '2003842656408578', '989106554552337', '988773191157765', '1750518241672539', '1696375800396854', '1052821828143109', '1101975213197949', '1818689078164305', '1340764792673326', '1196665787048646', '1044201475659209', '1130182873666293', '3173607405998636', '1275664972562703', '1026648920729545', '1872428116153565', '1225484597472435', '1207497572657758', '1942343732456615', '1312908222125035', '1332617726752141', '1524154440988718', '1360938750683878', '2172302616173639', '1119889274794166', '1155989791152285', '1592992710742424', '1994433897296970', '905830242847405', '1226573594029268', '1951786524835344', '2465382086809441', '1653313354717205', '1056843937708939', '2739977019349635', '903220709784607', '1070597869619581', '1388204261277129', '1425858557493354', '998016373574782', '1404029529689104', '1487646731309118', '1091604990907791', '1769388509760051', '888118474643317', '775907692521284', '682000918570174', '1490109271079729', '1312004685551779', '1143046855744783', '1184265584927845', '1441504575894342', '992124094188963', '1429983913766649', '1714408811965644', '1012092142167066', '1891601494191063', '1253785157981619', '1389400304430016', '818716001584299', '1162702973806457', '1633794490011975', '966424573479101', '1302715766408798', '1108062115894494', '1536415903036034', '1331308656942021', '929508627125435', '1001689043272976', '809977902464604', '957951994279023', '1001514393269541', '984294025016007', '1833318536683635', '2250162051701470', '1222120447828084', '1241059555937266', '1171399169574498', '1018772231550220', '1972405206119760', '1725310600873633', '1378281665554971', '1711938725528735', '1014328505355842', '993520564054974', '950252648400726', '986581138113138', '1480133245392512', '1041660492551211', '1962004113896614', '1087949831298664', '1644518545573145', '1696308540462484', '2143422815706213', '1021037564670339', '847961205328789', '1171384969561334', '1018110521596029', '703660393091961', '1620367211417812', '1495367467245425', '922402147808085', '989322321141039', '1003772722992854', '809121772547247', '1037581286304890', '1741124389277542', '1382388801879442', '2124641230881553', '1943333329057022', '1462259830529109', '1471853306166046', '1867571473257022', '1563237450413416', '2051702344842370', '1088797664494908', '1708711415835546', '1041269642652957', '1308114652607170', '2348743601909175', '1780851861955698', '1859625197439973', '1728510120524947', '1364142430316562', '1236704876366734', '1812602608857115', '1644704682289199', '1709744419154115', '1626271697482695', '1120724884606195', '1547059632027955', '1639775789405182', '1163831313746254', '1255051101208827', '1401567799948153', '1271135186302289', '1028758880514808', '1018613041536358', '1032148483570028', '903642616411015', '1264016100304079', '660396644063513', '1415202825245458', '1023198204421743', '1303301169681067', '733640976736718', '1101455296589556', '1116533615035202', '899545263499753', '1694532470661281', '1137856592928098', '1605035749512556', '415780415213995', '1246557958752994', '2683634734986656', '1154566214634850', '1098199910279475', '1037808739680311', '1072258406206619', '1801357889967877', '1208507739163035', '1003346543059420', '1879234558760878', '1297659106991992', '872418872856459', '881361898599169', '1859059894211295', '1586465688076128', '877457905696954', '1093392027448406', '1304877726278670', '1732987253448804', '1554270381357502', '974372449301580', '1148331945191570', '1588652084550780', '1671004309616863', '1106538986077576', '1905346406155912', '1263430353678786', '996543650418117', '2331434793563555', '2265255760180455', '1187328834649164', '1838305282891104', '1112286198806785', '1364532560285203', '1104933179620125', '2211192328903176', '1668330116583564', '997678176960598', '2001971263187898', '2032038366877571', '1744842135602990', '1513995308673845', '1868957053126430', '1365103133543739', '1262389360531123', '2532685170079555', '1211584462259537', '2130638416972998', '799798880126508', '1337951029631684', '1942845939155229', '1257029974329451', '940852485970061', '945831062186742', '2175239282518665', '1233145293403213', '1757663734343014', '1427932007323613', '1475034132510246', '974392602669459', '1491102584268860', '387422848047994', '1246744618768922', '1004289456346194', '1369078409873402', '2190323657748572', '1637736282963856', '1393269044113553', '1237907126312932', '1502397286503347', '1280760238690439', '1239815839467485', '819717231487370', '1072303152793390', '1219205288123671', '1477883658957255', '1257633284291446', '1892468820862074', '1630322847038003', '926295224105459', '996540877086329', '1340264072670004', '899832023465705', '922076897882360', '1330761650293612', '1077839092284541', '1297777480332012', '3076088545738492', '1304948539547215', '1009402919137992', '1961361990541898', '784129301688154', '3186673774691599', '1599261850117286', '1328782413814538', '1980580318635151', '2434016836627834', '1784204484986126', '1369785789766641', '1780741661944300', '1217155751659625', '1669550669760933', '1573602809425326', '2021788751258719', '1016967501697367', '1006887936048510', '943711145677315', '1861374180578892', '1958452074228276', '1317508468268608', '941682542593981', '1792930504091043', '1437580549697592', '2314034471989368', '900601920057477', '1238778229506924', '1533124226720250', '966139690133648', '1828209320545247', '2178820058825941', '1178419975552187', '898496780279952', '1707911292615524', '1439668599404073', '1534570166634001', '1410300449032431', '1098557506902587', '1429661883829354', '1000027913449340', '1320373124698683', '1048901365146027', '1755851804523719', '1011429558899116', '1430238500377664', '974756422624331', '1170137896430023', '2159136720763790', '864116003696703', '967071646715932', '1819708568043609', '1825580397453104', '1939359989460713', '1260824423952313', '2825239134154718', '1043217179077622', '828617117248161', '1781819921845915', '2317961328270454', '1266713943402009', '1694083923995617', '1488807047863347', '1944128808953270', '2069106006465690', '2339909156084669', '1789924451050066', '934743126624720', '1880529828633843', '1004798886239391', '2046553198725213', '1414258035336280', '1364510803659063', '1681506908561513', '1936945119708302', '1079392225455443', '1433592913387102', '1897965323553985', '1801263533272595', '2529055677154156', '1120256171368197', '804448142992694', '1795983737103675', '1794768633874464', '1570264743013105', '1266881563371842', '1174445049267874', '1873099679429920', '1184398028297648', '926273867499264', '2030694353661802', '1458299040905281', '1571751676192063', '804793456312081', '2272579216119318', '1109834805714906', '985909884864274', '980646215356452', '1002693133144449', '2009355295817444', '1834223926601207', '1170806652965871', '1497528783648022', '1501313913294054', '1607040142706621', '1829204770438255', '1244223995590142', '1021657354608408', '1939867142691966', '1530045857049581', '1180401875303371', '1514447601900695', '2011966668836710', '2001576096577657', '1177199742298383', '2050324821663886', '2127581660649280', '744866972281509', '1543794052351127', '1446531122131281', '1099633596804669', '1601514943210794', '2043644582332313', '1205125509544107', '1497930883561495', '2503391089702495', '1708460232526585', '1130704570365536', '1151513668302336', '1548193245307133', '1968393643280122', '1933468783441840', '1442212565828021', '1563751417029979', '1429281503799639', '1406167286077784', '961264563968531', '1431157710331223', '1371447689639525', '1370334862981714', '1115649871780498', '1830344467037360', '2437729269585986', '676747619095568', '859122784213043', '1406554962733693', '1112894815499116', '2069539006493937', '1386167224757449', '1290585534319768', '1239560486085016', '2833444230004406', '945551678861092', '1171309249602062', '1280395985421431', '1707073412706480', '2214244628588915', '1212860585450625', '1515033125183820', '1956900951038026', '1765028786864131', '1379869002120921', '1605007349543688', '1717687071655033', '1319276384868331', '1681857008586292', '1564171116930006', '1264718836934108', '828122903980238', '1823346271013120', '1228071717284478', '1700554169987044', '1074931595875342', '1055156107907425', '1314003758671555', '1184973554901426', '954357068025555', '1030319333676340', '1361822510535509', '1026362144104451', '1881504281860877', '1833034253377885', '1042977572425760', '1303015946406069', '1434219906691531', '1843267285686806', '1395843387173061', '711797622254827', '1413798101973547', '2092820447458370', '1126239044115355', '1368207159902538', '2037840999649560', '1936934136403643', '1305408259557493', '1316179438395871', '1807317409310025', '1329190610448460', '1220851764689273', '963903800312416', '1630925520317416', '1482485498505274', '1266404800079388', '1083926491698432', '1437622026333338', '2221241921234738', '2803888673016355', '1570513163000320', '1116053935181362', '1808843195822325', '2192753377451572', '1649724921807779', '1558212447531205', '1138122202866373', '1355935294487891', '1127998673964713', '1942516192430431', '1210327769037332', '1458496604197649', '1764424466901461', '1884062488298857', '1818052548258452', '1093964344057482', '1277986908983013', '1072584966163425', '1821664114572538', '1762660917100389', '1266926693358965', '2716628805044056', '1171450826315858', '1176018695854120', '2027380550714273', '1218229098261852', '2417599994919704', '1549820201776682', '1596813403689581', '1646255608742335', '1338537909564174', '933665076734267', '2749858231721083', '2125948974167426', '1233189620061747', '1838344072944378', '2430833096985070', '1936824813058020', '1647847635331593', '1890872267591369', '2873869776021085', '1309916592361067', '2445794025511978', '1258599840927577', '2382921018457845', '2377879608899124', '1478494128914114', '1340822289353901', '1659030634151539', '1359906420787878', '1152665388102053', '1982154598578998', '1331089120285846', '1764886996904959', '2617326894946403', '1703620889728825', '1510962015642292', '1766848360109262', '2020666424613572', '1723287424432047', '1037679502967606', '1132882333473147', '3127208930638510', '3016233988450211', '1269203056439779', '1501889473210330', '1875140845836625', '1802689989806230', '1823664821020140', '2521589964574061', '2197829460229187', '1551361978320246', '1530756597021244', '2568415779851053', '1989020754502226', '1731009406957041', '1746672708729216', '1676378872427800', '2084362931627708', '2004005749696280', '2341952762531753', '2374565852633484', '1801857816550517', '1585189354891625', '1310377192398042', '2455309591158227', '2109562142495943', '2875283785833437', '2395882980466838', '1272728086074533', '1379022322193957', '1800943179957282', '1447092712011287', '1871244019630887', '1571143122994237', '2685037768176551', '2157136304330778', '1656567794425255', '1739861202717667', '2283102065036440', '1130324113733102', '1635318426577306', '2298826323547241', '2499688966768965', '1813649398677830', '1249428591772689', '1978368332236407', '2412559585428662', '1608277092625410', '1217471878365796', '2315978125097109', '2343958732291362', '1963156610459395', '1809390489075678', '1569100436498535', '1393627804009838', '1528291040618527', '1539436692808738', '2244454088961520', '1264925233525864', '1633591910075916', '1906169082766471', '1027083374084674', '1204731822978255', '1526202524057260', '1593448240768245', '1549570518416178', '1495752170441838', '863429780424942', '980771811959458', '1182380518443666', '1942869395829207', '1612596228785432', '1083042371786607', '2467364466642773', '2236816239697496', '1848693088593147', '2322509624489511', '1727568557317122', '1036513769804225', '1533231583438824', '1810750645607190', '1861486733959164', '1934325366646856', '1052304794886863', '868994813199968', '1693860204017792', '1371598756291017', '2064058367012312', '1899493143484255', '2153044944803186', '2814164681959269', '2245058338849660', '1482674305192007', '1680689561950120', '1831386233574800', '2494578553916335', '1731587616863812', '894396277346731', '1819090908122358', '1536691996410477', '1445682265455753', '1388639557852285', '2004480829667770', '2074142215952465', '1269833109744113', '1840170016011204', '1351689804896807', '998287880282507', '1721877701263640', '1717426128288170', '1193480720725056', '1227243557300361', '1580302658646825', '2327369464045681', '2848450968560936', '1806879052690683', '1274544649278305', '1261519543970221', '1306960842762131', '1409251412531103', '2598026453602199', '2062124740479338', '1313745845396420', '1402173103165354', '1319888571402315', '2473226992719549', '1591073590972727', '2151091991592678', '1452659618102144', '1733132530096377', '1126929450705962', '2475982895775029', '1786072758117223', '1505100179544569', '892995210804059', '2815210175190743', '1625302357538878', '1119119774880083', '1829062873855832', '1125327370889861', '1621604147940095', '1449841275090025', '1077869272314219', '1360558234048246', '802980189823946', '1269884236472140', '2019557031470428', '814255758700053', '1722022914546610', '1424068284285734', '921646244607721', '911038425617832', '1794257190678814', '2435949193099067', '1535006473286280', '1333332663409996', '1783477358391522', '2192488214151961', '1473162759461410', '1432150526836829', '1586295238060018', '2348525895219446', '1913419862118272', '2954726801212018', '1293266627457596', '1339334626175018', '1408091119267920', '2583849224982166', '1554522858001622', '750910405009643', '1873145426039242', '1744923325584653', '2425430174174472', '1221236131237268', '1166109406809620', '1439655272812082', '1633473423412643', '1766581036755768', '1929582850483565', '2372061992856432', '1001270106613504', '1548858791808985', '2177793142230915', '1896020410412423', '2224171020955231', '1460009300763639', '2224518224242612', '2664057663668988', '1846751478700515', '2447509701930418', '1304020072983542', '1606205652783585', '980197902105373', '2065023576942465', '1805899282773910', '1980860325355938', '1882294268491131', '2414647548548968', '2037218276323946', '1883364855049025', '1358967810826101', '1556750707686722', '1602353583119271', '1916662391793038', '1145588855531274', '1835083489951084', '1156315807813887', '1666674673366568', '1690625944347859', '1333056616777885', '1213846312045524', '1461392610653814', '1274858305906473', '2496339380383114', '2775569789182890', '2244062122297088', '1400181626701009', '1923407444400871', '1815215245225612', '1343033292436240', '1552250918219351', '1547231975368367', '1652078998203854', '2149603455084781', '1053122028117467', '1681590791888234', '1242416849112952', '2297649763591594', '1610155619109869', '1645454705482018', '1642935482491477', '1776111379163747', '1848918321866938', '1228605373923715', '1445083275615167', '1397433300276519', '2365996083419774', '2267941936565944', '1058565827499028', '1978266905591447', '1561251624004468', '1377122479022118', '1434373533324180', '1058884440821872', '1506609942759571', '1269189123141874']
# 1389

# %%% initialize chrome
# open website
driver = Chrome()
time_star = time.time()
# %%% collect all reviews
condition_to_continue = True
dataframe = pd.DataFrame()
count = 0
#id_list =['2734683026604050', '1081190428622821', '2031736060288351', '2472374902778951', '1111640318951750', '1198491230176054', '1069133196442024', '1659250310762797', '1368187813209608', '909129545868758', '872183756232656', '1012593518800648', '1446648452044502', '866068943510454', '1896033800492877', '1115950031749190', '2239010642792458', '1195983747083203', '1216866718419997', '991947850898357', '1051675701628540', '2003842656408578', '989106554552337', '988773191157765', '1750518241672539', '1696375800396854', '1052821828143109', '1101975213197949', '1818689078164305', '1340764792673326', '1196665787048646', '1044201475659209', '1130182873666293', '3173607405998636', '1275664972562703', '1026648920729545', '1872428116153565', '1225484597472435', '1207497572657758', '1942343732456615', '1312908222125035', '1332617726752141', '1524154440988718', '1360938750683878', '2172302616173639', '1119889274794166', '1155989791152285', '1592992710742424', '1994433897296970', '905830242847405', '1226573594029268', '1951786524835344', '2465382086809441', '1653313354717205', '1056843937708939', '2739977019349635', '903220709784607', '1070597869619581', '1388204261277129', '1425858557493354', '998016373574782', '1404029529689104', '1487646731309118', '1091604990907791', '1769388509760051', '888118474643317', '775907692521284', '682000918570174', '1490109271079729', '1312004685551779', '1143046855744783', '1184265584927845', '1441504575894342', '992124094188963', '1429983913766649', '1714408811965644', '1012092142167066', '1891601494191063', '1253785157981619', '1389400304430016', '818716001584299', '2250162051701470', '1162702973806457', '1633794490011975', '966424573479101', '1302715766408798', '1108062115894494', '1536415903036034', '1331308656942021', '929508627125435', '1001689043272976', '809977902464604', '957951994279023', '1001514393269541', '984294025016007', '1833318536683635', '1222120447828084', '1241059555937266', '1171399169574498', '1018772231550220', '1972405206119760', '1725310600873633', '1378281665554971', '1711938725528735']
#id=1331308656942021 有问题
id_list = ['1279952315376503', '969815736436279', '1498526623509747', '827294127398133', '1198492796853678', '1251787591581936', '1164252963696830', '1176652609059507', '940410229366998', '1063691710368492', '1130312973723945', '1190441294377640', '941837879186570', '1261331807302580', '1155364627825721', '1124164450939641', '927672977351617', '970225196383135', '869694586482674', '970981526326393', '977115909056929', '779304552192363', '874426845997680', '2247877368571344', '1341671792523028', '1035061809913798', '859807967457408', '1135654449807002', '1088313964515376', '1028359287211728', '1111432215631156', '1246280708824029', '1389161184521528', '802035973257758', '1383189711751416', '701113843332342', '1238852986197676', '1113617725394318', '1250268818411608', '727513797376784', '1401343996605343', '948175608590153', '2027653017260426', '1232181650154576', '1402084486500779', '1407846952568081', '1257988667656584', '2865608840146763', '994229133962087', '838122072929207', '1159244034143439', '1311119432246338', '1363125447085111', '1723271804396968', '1458129140982015', '1039551732766812', '893462057375013', '1179587862133850', '1750042515043543', '1129567930394285', '869062649886828', '1076393782417282', '1564071926993433', '1265881140114780', '978858615575041', '1585261441509589', '1490394380970763', '1085190581588500', '1157662374252543', '890562797701371', '888655704564160', '2182380691837266', '977682228969521', '1148894061844063', '1163301273699318', '1423686654360310', '1533717109978548', '1206152689481565', '835782169860964', '1644126292264565', '855607711227110', '1884542518224310', '1358025144231073', '1742740612417684', '1168200286607832', '1256687334386627', '1483105368478205', '1599089200204462', '702313006537899', '1245015338916107', '994223077313205', '909222225797509', '1692800674095423', '967457083325115', '1476883939049726', '984128001677065', '2515738525108145', '1093678027375678', '1399384500081918', '962797827179803', '1316393138403817', '1845987428750183', '2108210925919661', '1327971593879954', '999953676712829', '2252817104759749', '1115223751871877', '945657588886188', '1093086134103708', '1146999932052027', '1276628095785788', '686548444781796', '1196934083758151', '956122117804455', '2114496781900803', '1437625272921371', '1100532370053538', '1290835750988761', '1759965414055326', '1429287810430225', '1432333916895911', '1328279610555554', '1397570263626312', '1239896026125279', '869485659814410', '906577009374541', '1152440564774310', '1514501481946313', '929143807179080', '1745900872117882', '1175172312522689', '2098235286868577', '1656522077759220', '1165889830098769', '693852360737481', '821606624632569', '1792865820758773', '2600000103359534', '1272280566205677', '743301119132072', '1272636489423125', '2187469658010419', '985740968178995', '1040150542725228', '1309677705722446', '1769193356487183', '1506375586042095', '839109046206257', '1016573058409292', '1329467047134070', '1414727911938710', '1820733047940852', '1164116493649406', '953565778099802', '1199148026798440', '971783956201151', '930936790307567', '1267165856658187', '1662599157093813', '1105507662843899', '1220361218019062', '1308431799167967', '1082826128464888', '2084588764916379', '820253268102944', '1317796131632528', '1152938968151435', '1645146858877576', '1136466006397282', '2151654038193242', '1210834605638180', '1151852774921213', '1311702362213668', '1475724512535901', '1559571227451352', '981183751998516', '1308274785931781', '1397503436990351', '1588092357883622', '937155399709711', '1705533536145044', '1433607290033029', '943045389086673', '1012545955507257', '1994117610669719', '1236726999709837', '786032018149180', '1015802351839289', '1010026535719776', '953048504789375', '1096173157163965', '1055629531142378', '1051452461583340', '1458677940864975', '1430068307034578', '2057813437660352', '1176281109085323', '1596151970428159', '1213715582017059', '1138465426283227', '1039052029463099', '815449458566728', '1429922917049065', '1002899163116852', '764544883656394', '1107766839328808', '1330308093710823', '817920331578674', '1274071716010063', '1149523025079174', '1188183857876754', '1150151301762838', '1094257107281857', '1408045589285371', '1900868696672010', '1237598576314376', '1282459145111104', '1165266710246286', '1073856559366835', '1326195317491993', '941114969346892', '1666153080144269', '1427867497231007', '1228338660532183', '1068419409885057', '1094315670658189', '1834522029951979', '957887340986022', '1161055827278470', '1170793196320382', '1880730948683634', '977671432283223', '942681562482500', '1297352360374984', '1827480957263521', '1416383481777117', '1079053475440244', '1065433633539161', '1054521054630234', '1093617717347270', '1052195828241004', '1115959265146824', '1519842891421902', '1442492449205817', '1086522398130218', '1411919038919717', '1098948016789124', '1387612654617200', '1237657979662216', '817961768314571', '1032865413439300', '939287339491032', '686602718141033', '916630401745678', '1636781966561983', '1193386440728067', '967592450025614', '1179052298807928', '1350225515008434', '697506160349280', '1593975777342062', '796067960495193', '1383443071767092', '1231125970313284', '1199482320162285', '1388274394547955', '1134330346692366', '1457959427660729', '872167559579148', '1599951280035164', '888915797823449', '2264650486940997', '968122466570458', '1789588554444599', '1127993887274347', '1831456410217224', '899401630172187', '1240594359359841', '1896659680406341', '971517676219009', '1046954465328733', '913133022131504', '1876666982349412', '637999199658181', '1219562808069896', '1488036287899838', '1195599640458896', '1462012723846452', '1009578569110975', '1523573664385045', '1830914413625836', '1514862561912745', '1118136401544593', '1059251330800683', '1447414238628186', '1135979366469525', '1299759793383168', '1274880599305742', '1805572406228951', '704783576291313', '1117186341654722', '974420059288856', '955341724542883', '905254456232781', '1071493689558158', '2217620391643401', '1138293276254282', '1497597723606634', '1324679164310094', '1398803443503693', '1168388049887478', '1072311739534695', '1433153263377039', '1697635493609842', '764533217004821', '1188879784477485', '1748557301886748', '1454501874624337', '924173877658832', '1341118532667756', '1130513737020611', '1139013382857601', '890483591029810', '1723715221033555', '1265732843505431', '2176642949027006', '1268902426499564', '1087059131366738', '1147672638577288', '1617001221678467', '1036701589724698', '1419924494723130', '1300263013349763', '1045211762197999', '733522390097976', '983261678442712', '1277243192403413', '1471880979518893', '914641785316114', '982771795100769', '892968027463189', '1207118549384855', '1467388843347781', '1436166546433138', '1381620821905816', '1376933662397923', '1509267782486482', '1073687572742391', '1648291811865437', '992805010809326', '1134135246646346', '976046909159185', '2276703325689158', '1045447662230249', '1462960343734947', '1723398854346437', '803125203132875', '1542475959125207', '1174459059254863', '546512902140409', '1371929766155309', '1124492254298555', '2620140564669029', '1450046085032785', '1063631660393184', '1605631809450889', '934674339915892', '2007297379312180', '1489708541098941', '906668589398293', '2097674173595005', '875428372564907', '1036229976435667', '1357775034303335', '1973697659322414', '1163142207041311', '1441572095934452', '1040690412651736', '2154723571220481', '1245762395484541', '1227885143989447', '1178115748953782', '2090322207665366', '1292530930842918', '749068321865534', '844232452316302', '1938563662840722', '1598126356885122', '1465981820197033', '918149864931844', '1100747383337483', '1290744591003482', '1209715682430322', '933094993466147', '1496877757007000', '972238829539957', '1509521155763419', '559903100780155', '1301644406556801', '1079594602147368', '1934075829959225', '1338189622959415', '1684580334920669', '1010228079090313', '1013248532088752', '1532533733438338', '1169318969854411', '1581112278669461', '1596879180334336', '1428287320528005', '1476293569079509', '2185901951459621', '1464810520216368', '2002118589833747', '1242900092425846', '1426119180771781', '1678578035508341', '1267959529922459', '2893734833988477', '1392230570811021', '1612336165492390', '1308960369180690', '1426313427425846', '1676554809053136', '1900559300017262', '1480250182029706', '1898302430210613', '1513516468676920', '1443717742338698', '1759430264082060', '1317137055078757', '1534966199966470', '561975990594103', '1451389781576652', '1607027939327680', '2029486033737792', '1158666007581635', '1466906033365597', '2129964383789845', '1544656912313859', '1181750045204379', '992503684170594', '1700097443425061', '2799914226690358', '1340257456032031', '1284669471561141', '1491256844278639', '1637576082944853', '878262692296965', '1212238368891470', '2306542396125503', '2228185307227987', '1787446041296195', '1520039134732158', '1325747684190991', '1928612897204217', '1899081083467955', '1152853434785277', '1641698295876186', '1548818075148912', '1075078902529655', '1091395807610779', '1378834245571358', '2512152512128560', '1580086868693812', '1978400832224524', '1317308518366695', '1449315501801273', '1599103100154572', '1153993427965181', '1368262083207740', '1645503818802339', '1830245480376318', '1175048312616465', '1432145000151577', '1162516107186541', '1258286144210734', '1091161604315290', '974760535972181', '1090623134367376', '1524331530931445', '1322966301106903', '999890153455291', '1666667546723525', '899462693513985', '1174624452648980', '1395533030506291', '1628782007201790', '1301310243262546', '1285913318105808', '1333194773387958', '1270657409683040', '2438115112900489', '1678720028842346', '1520090358049199', '1272105756135847', '2412287618791781', '1852276078160450', '1516314451794036', '2675214445841036', '1807979115894017', '1378196722247293', '2391154734289067', '909419709141137', '1297121060348906', '1328569307244888', '1623020254404709', '1063671847025811', '1355030521256699', '1283121388441343', '1078418522275392', '1399736556800852', '1732459530190629', '1950944974977236', '2256634431075894', '1452652771522462', '1886792921395838', '1352186361535874', '1344998125594670', '1110379669015074', '540612449397326', '1147504798711619', '2011554565528441', '1431663703559274', '2375089935867236', '1875029342532764', '2057487257609586', '1135300939906841', '1092021544167262', '1225987560770270', '1794758713929287', '1110609692373708', '1280948248695306', '1196489400366340', '1597871153556553', '2870922692924167', '1308265182572962', '1367312796675079', '1017219438375731', '1908181425937092', '1123268427742395', '1507202936002141', '1712701125524929', '1268267383280759', '1711331018908673', '1229011070478055', '1166921553428197', '957997940977508', '1465353230246194', '1452559921492021', '1325781514215661', '1283593541663549', '2276532692364976', '2186133398134464', '2379075352124947', '981318185303176', '893710327423160', '1121696511262288', '1286670651462332', '1334274669982503', '2130603867065604', '1232027913518496', '921656151286079', '1420430074634461', '2155932074427642', '2180145435376518', '1569958703060229', '1532242463518401', '1922500497798790', '1164460086899321', '1583918168354660', '1339412772801750', '1356480411048998', '1298464133518361', '1440165489329446', '1259402970855150', '1756049414428886', '1433622983379399', '1220794534690602', '1812156665514011', '2210735768999489', '982319468556497', '1254142181323692', '954104248027422', '1525706217501664', '1635424006496446', '1180729541968442', '1319349118175460', '1177831912305073', '2708876125851246', '1385997328128629', '2275610949145387', '1020553151375912', '1420999057968520', '1440520392683206', '1640145679355737', '1317775404987235', '1233634056684177', '2092748130793752', '1059403080823692', '667586660033140', '971267076294181', '1471907882820219', '969647779805902', '1588524314531974', '1679473835427082', '1078672635555366', '1437255003009427', '1626597084076889', '2099304230107998', '1235740319862860', '814352192025674', '1396595220453211', '1554308144580814', '1252159258183113', '1624825357552159', '1836237233067947', '1204677752953729', '1221498017906287', '1538140602922694', '1162552413848721', '1749644671743547', '1546565872084156', '1303645319717831', '1634724596608007', '1170319423083270', '1833979673378882', '1702109373193083', '1625218054204184', '1754893891296534', '1784196901608145', '2351409044933732', '1278997645522490', '1554030881307119', '2054882794628533', '1215157815235643', '1469400176440180', '1793760207315627', '1689879184370118', '1905692212790937', '1035656763205647', '1992910510749351', '1281474908540066', '1565988873492912', '1584063351668198', '1770956259651277', '1655485311168943', '1846476648763111', '1046051945517101', '1063268023713893', '1171685502873385', '1303554596363883', '1206286042744297', '1787978867893011', '2079355438825794', '1267305453346375', '1548442951878869', '1143782212362210', '1348481425226688', '1478011548974390', '1602299743220506', '908477449239883', '2043845889041446', '951652424934219', '1061163433982769', '1569646243091586', '1622889807727101', '1864040280361040', '1287460564696738', '1548048885290179', '2093812247356634', '1705352709495577', '1264133353659580', '1659646724105274', '1480767155334570', '1715978015184865', '1198578316858824', '1890936197643447', '1663834653648968', '2616991518375078', '2289190954438865', '1471215239650265', '1423116051095443', '1361260200560167', '2828871417128045', '2204474006269312', '1362025037191930', '1688731664551831', '2078634555484217', '1442836775781939', '1916562741759022', '2037076092976380', '1031509710236946', '1520619047980648', '1525053574253194', '1546529198754283', '1881627821956963', '1363598240361842', '1262694413787430', '1115233775178991', '2204872436205921', '1509620452468804', '1879753195405538', '893040984131487', '1461025750594133', '1698492586827840', '2281308988561276', '1814074872024230', '1154831971295440', '1019232254855150', '2207792252593533', '1322583501119472', '1260639860676726', '1599493453504097', '1205339442875040', '1887659707932041', '1377453642353176', '1224996980954613', '1428450880592282', '1504340412919363', '1463424230375092', '1451786331579849', '1790296634334754', '1529642327114669', '1272734082822892', '1386589188087777', '1442483992493834', '1846061835437872', '1122106037877975', '1739742929422865', '1876389955711118', '1394125794047019', '1288009774648332', '1273927426067860', '1470125693110838', '1738644689480166', '1126549040781694', '1535892633199890', '1842151349133213', '1360758617303204', '1216567281785099', '1124928977555956', '1161174933903621', '966225633431829', '1122461717862966', '654321418025343', '999379943483728', '1643410052385601', '1473384542775031', '1808488179169635', '1732706276770632', '1814064888639379', '2107904142590556', '1951143931639691', '1351920194853562', '1809903285787051', '2087296411294473', '1940525362686304', '2049465185091157', '1371395432934029', '1315782518472243', '1625574517548862', '1399933736741689', '1833871373366446', '1544852308893316', '2018808911513771', '2351348738262431', '2572765362752733', '1170221253080258', '1793876507292640', '1597710370263546', '1432087140161924', '1797880253649468', '2391301350920453', '1411824152268110', '1509475115757106', '1446566452123631', '2207336269341040', '2912001178840686', '1345702172172075', '2265625690131356', '2374896715854432', '2727455957282664', '3013336705359381', '1869628566461582', '1806945789372143', '2447104348661495', '1670711503018722', '2415663465145235', '2234270353278570', '2275042335871751', '2233797386689323', '1725243257523071', '1890484677736105', '2016525948452071', '1930601700380887', '2870120766391290', '1987533984643241', '2351269664950003', '2431650880193511', '2000082323451525', '2326620234111426', '2394684733881252', '2698267323547921', '2334378369971067', '1795066593933270', '1715044728551108', '2117987304980708', '2376557319093072', '2001216633317459', '2471769576279885', '4127185524022123', '4023694967657163', '3990881570986809', '3965164823509171', '3916203871786673', '3743290205690918', '3693047404070061', '3632968493433188', '3466107356802122', '3439106192779539', '3396804017029127', '3289830014445026', '3264201193655001', '3165818406825516', '3157815160909601', '3152675004789593', '3106370362755398', '3089033354457696', '3037861916323709', '3005463392867501', '3002596863131752', '2990946714347209', '2990066157760608', '2964746063538386', '2955928654482306', '2949706498471115', '2923592861069433', '2859319657439742', '2854529151320593', '2804027686332570', '2801915273179041', '2800193046668553', '2763382083760407', '2751826864934523', '2745449288824134', '2689829444436027', '2654569334651872', '2610169122379924', '2584242601671594', '2557714124311431', '2528862540515417', '2501676163286296', '2451721584863689', '2451393778316809', '2307438349367687', '2301106566668122', '2085468338152617', '1847929188664915', '1111192718996912']
print(len(id_list))
n = 0
k = 0
worry_list = []
#得到商品的所有共同标签，将标签内容传到soup中
#循环打开游戏的页面，获取上面的信息
while(condition_to_continue):
    while(n<len(id_list)) :

        # 得到商品id，通过访问url将商品信息输进去
        url = 'https://www.oculus.com/experiences/gear-vr/' + str(id_list[n])
        n = n+1
        k = k+1
        driver.get(url)
        driver.maximize_window()
        windows = driver.window_handles  # 获得多个窗口句柄
        print(windows)
        #node_handle = driver.current_window_handle
        driver.switch_to.window(windows[-1])
        #print(node_handle)
        #driver.switch_to.window(windows[0]) #切换窗口
        time.sleep(2)
        try:
            page = driver.find_element(by=By.XPATH, value='//*[@id="mount"]/div/div[2]/div/div/div[2]')
            #print(page)
            soup2 =BeautifulSoup(page.get_attribute('innerHTML'),"html.parser")
        except:
            print('第二页跳转失败')
        try:
            app_details = soup2.find_all('div', attrs={'class': 'app-details-row__right'})
            print(app_details)
        except:
            print("取游戏细节出错")
        try:
            iteam_name = soup2.find('div', attrs={'class': 'app-description__title'}).text
            print(iteam_name)
        except:
            iteam_name = ''
            print('获取商品名字错误')
        try:
            iteam_description = soup2.find('div', attrs={'class': 'clamped-description__content'}).text
            print(iteam_description)
        except:
            iteam_description = ''
            print('获取商品简介')
        try:
            iteam_price = soup2.find('span', attrs={'class': 'app-purchase-price'}).text
        except:
            iteam_price = ''
            print('价格失败')
        try:
            if len(app_details) == 13:
                print(id_list[n-1]+'.csv')
                dataframe = dataframe.append(pd.DataFrame({
                    'Game_Id': id_list[n - 1],
                    'Game_Name': iteam_name,
                    'Game_price': iteam_price,
                    'Game_description': iteam_description,
                    'Game_Modes': app_details[0].text,
                    'Game_PlayerModes': '',
                    'Game_Tracking': '',
                    'Game_Controllers': app_details[1].text,
                    'Game_Platforms': app_details[2].text,
                    'Category': app_details[3].text,
                    'Game_Genres': app_details[4],
                    'Game_Languages': app_details[5].text,
                    'Game_Version': app_details[6].text,
                    'Game_Developer': app_details[7].text,
                    'Game_Publisher': app_details[8].text,
                    'Game_Website': app_details[9].text,
                    'Game_ReleaseDate': app_details[10].text,
                    'Game_Policy': app_details[11].text,
                    'Game_RecommrndedCPU': '',
                    'Game_RecommrndedGraphics': '',
                },
                    index=[count]))
                count += 1
                print(count)
                dataframe.to_csv("GearVR_Iteam_message.csv", index=False, sep=',', encoding='utf_8_sig')
                time.sleep(2)
                break
            if len(app_details) == 14:
                print(len(app_details))
                print(id_list[n-1]+'.csv')
                dataframe = dataframe.append(pd.DataFrame({
                    'Game_Id': id_list[n - 1],
                    'Game_Name': iteam_name,
                    'Game_price': iteam_price,
                    'Game_description': iteam_description,
                    'Game_Modes': app_details[0].text,
                    'Game_PlayerModes': '',
                    'Game_Tracking': '',
                    'Game_Controllers': app_details[1].text,
                    'Game_Platforms': app_details[2].text,
                    'Category': app_details[3].text,
                    'Game_Genres': app_details[4].text,
                    'Game_Languages': app_details[5].text,
                    'Game_Version': app_details[6].text,
                    'Game_Developer': app_details[7].text,
                    'Game_Publisher': app_details[8].text,
                    'Game_Website': app_details[9].text,
                    'Game_ReleaseDate': app_details[10].text,
                    'Game_Policy': app_details[11].text,
                    'Game_RecommrndedCPU': '',
                    'Game_RecommrndedGraphics': '',
                },
                    index=[count]))
                count += 1
                print(count)
                dataframe.to_csv("GearVR_Iteam_message.csv", index=False, sep=',', encoding='utf_8_sig')
                time.sleep(2)
                break
            if len(app_details) == 15:
                print(len(app_details))
                print(id_list[n - 1] + '.csv')
                dataframe = dataframe.append(pd.DataFrame({
                    'Game_Id': id_list[n - 1],
                    'Game_Name': iteam_name,
                    'Game_price': iteam_price,
                    'Game_description': iteam_description,
                    'Game_Modes': app_details[0].text,
                    'Game_PlayerModes': app_details[1].text,
                    'Game_Tracking': app_details[2].text,
                    'Game_Controllers': app_details[3].text,
                    'Game_Platforms': app_details[4].text,
                    'Category': app_details[5].text,
                    'Game_Genres': app_details[6].text,
                    'Game_Languages': app_details[7].text,
                    'Game_Version': app_details[8].text,
                    'Game_Developer': app_details[9].text,
                    'Game_Publisher': app_details[10].text,
                    'Game_Website': app_details[11].text,
                    'Game_ReleaseDate': app_details[12].text,
                    'Game_Policy': app_details[13].text,
                    'Game_RecommrndedCPU': '',
                    'Game_RecommrndedGraphics': '',
                },
                    index=[count]))
                count += 1
                print(count)
                dataframe.to_csv("GearVR_Iteam_message.csv", index=False, sep=',', encoding='utf_8_sig')
                time.sleep(2)
                break
            if len(app_details) == 16:
                print(len(app_details))
                print(id_list[n - 1] + '.csv')
                dataframe = dataframe.append(pd.DataFrame({
                    'Game_Id': id_list[n - 1],
                    'Game_Name': iteam_name,
                    'Game_price': iteam_price,
                    'Game_description': iteam_description,
                    'Game_Modes': app_details[0].text,
                    'Game_PlayerModes': app_details[1].text,
                    'Game_Tracking': app_details[2].text,
                    'Game_Controllers': app_details[3].text,
                    'Game_Platforms': app_details[4].text,
                    'Category': app_details[5].text,
                    'Game_Genres': app_details[6].text,
                    'Game_Languages': app_details[7].text,
                    'Game_Version': app_details[8].text,
                    'Game_Developer': app_details[9].text,
                    'Game_Publisher': app_details[10].text,
                    'Game_Website': app_details[11].text,
                    'Game_ReleaseDate': app_details[12].text,
                    'Game_Policy': app_details[13].text,
                    'Game_RecommrndedCPU': '',
                    'Game_RecommrndedGraphics': '',
                },
                    index=[count]))
                count += 1
                print(count)

                dataframe.to_csv("GearVR_Iteam_message.csv", index=False, sep=',', encoding='utf_8_sig')
                time.sleep(2)
                break
            if len(app_details) == 17:
                print(id_list[n-1]+'.csv')
                print(len(app_details))
                print('到这一步了')
                dataframe = dataframe.append(pd.DataFrame({
                    'Game_Id': id_list[n - 1],
                    'Game_Name': iteam_name,
                    'Game_price': iteam_price,
                    'Game_description': iteam_description,
                    'Game_Modes': app_details[0].text,
                    'Game_PlayerModes': app_details[1].text,
                    'Game_Tracking': '',
                    'Game_Controllers': app_details[2].text,
                    'Game_Platforms': app_details[3].text,
                    'Category': app_details[4].text,
                    'Game_Genres': app_details[5].text,
                    'Game_Languages': app_details[6].text,
                    'Game_Version': app_details[7].text,
                    'Game_Developer': app_details[8].text,
                    'Game_Publisher': app_details[9].text,
                    'Game_Website': app_details[10].text,
                    'Game_ReleaseDate': app_details[11].text,
                    'Game_Policy': app_details[12].text,
                    'Game_RecommrndedCPU': '',
                    'Game_RecommrndedGraphics': '',
                },
                    index=[count]))
                count += 1
                print(count)
                dataframe.to_csv("GearVR_Iteam_message.csv", index=False, sep=',', encoding='utf_8_sig')
                time.sleep(2)
                break
            else:
                print(len(app_details))
                print(id_list[n-1]+'.csv')
                print('到这一步了')
                dataframe = dataframe.append(pd.DataFrame({
                    'Game_Id': id_list[n-1],
                    'Game_Name': iteam_name,
                    'Game_price': iteam_price,
                    'Game_description': iteam_description,
                    'Game_Modes': app_details[0].text,
                    'Game_PlayerModes': app_details[1].text,
                    'Game_Tracking':app_details[2].text,
                    'Game_Controllers': app_details[3].text,
                    'Game_Platforms': app_details[4].text,
                    'Category': app_details[5].text,
                    'Game_Genres': app_details[6].text,
                    'Game_Languages': app_details[7].text,
                    'Game_Version': app_details[8].text,
                    'Game_Developer': app_details[9].text,
                    'Game_Publisher': app_details[10].text,
                    'Game_Website': app_details[11].text,
                    'Game_ReleaseDate': app_details[12].text,
                    'Game_Policy': app_details[13].text,
                    'Game_RecommrndedCPU':app_details[16].text,
                    'Game_RecommrndedGraphics':app_details[17].text,
                },
                    index=[count]))
                count += 1
                print(count)
                dataframe.to_csv("GearVR_Iteam_message.csv", index=False, sep=',', encoding='utf_8_sig')
                time.sleep(2)
                break
        except:
            print(id_list[n-1] ,"写文件出错")
            worry_list.append(id_list[n-1])
            print('worry_list',worry_list)
            n = k
            continue

















